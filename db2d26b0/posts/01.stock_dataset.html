<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="agsu">
<meta name="dcterms.date" content="2022-07-06">

<title>Data Analysis blog - [stock prediction] 1.1 ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data Analysis blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ag-su"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://agsu.tistory.com/"><i class="bi bi-box2-heart" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[stock prediction] 1.1 ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">project</div>
                <div class="quarto-category">stock prediction</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>agsu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 6, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="baseline-model" class="level1">
<h1>1. baseline model</h1>
<section id="ë¨¸ì‹ ëŸ¬ë‹ì„-ìœ„í•œ-ì£¼ê°€-ë°ì´í„°ì…‹-ìƒì„±" class="level2">
<h2 class="anchored" data-anchor-id="ë¨¸ì‹ ëŸ¬ë‹ì„-ìœ„í•œ-ì£¼ê°€-ë°ì´í„°ì…‹-ìƒì„±">1.1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±</h2>
<p>ë³¸ ê¸€ì—ì„œëŠ” <code>ì‹œê°€, ì €ê°€, ê³ ê°€, ì¢…ê°€, ê±°ë˜ëŸ‰, ë³€í™”ìœ¨</code>ë¡œ êµ¬ì„±ë˜ì–´ìˆëŠ” ì£¼ê°€ ë°ì´í„°ì…‹ì„ ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµì„ ìœ„í•œ í˜•íƒœë¡œ ì „ì²˜ë¦¬ í•©ë‹ˆë‹¤. ë˜í•œ, ì´ ì „ì²˜ë¦¬ ê³¼ì •ì—ì„œ ì²˜ìŒì— ì‹œë„í•˜ì˜€ë˜ ë°©ë²•ìœ¼ë¡œë¶€í„° ì ì°¨ íš¨ìœ¨ì ìœ¼ë¡œ ê°œì„ í•˜ì—¬ ì²˜ë¦¬ ì‹œê°„ì„ ì¤„ì´ëŠ” ë°©ë²•ì˜ ê³¼ì •ì„ ë‹´ì•˜ìŠµë‹ˆë‹¤.</p>
<p><br></p>
<section id="ë°ì´í„°ì…‹-ì •ì˜" class="level3">
<h3 class="anchored" data-anchor-id="ë°ì´í„°ì…‹-ì •ì˜">ë°ì´í„°ì…‹ ì •ì˜</h3>
<p>ë³¸ ì—°êµ¬ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµì„ ìœ„í•œ ë°ì´í„°ì…‹ì€ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
<ul>
<li><p><strong><code>ì¡°ê±´</code></strong>: ì „ì²´ ì•½ 2000ê°œ ì¢…ëª© ì¤‘ 2018ë…„ ë¶€í„° ì¡´ì†í•˜ì˜€ë˜ ê¸°ì—… ì¤‘ ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒ ë°œìƒí•œ ë‚ ì§œ (ê±°ë˜ëŒ€ê¸ˆì€ ì¶”í›„ì— ìˆ˜ì • ì˜ˆì •)</p></li>
<li><p><strong><code>ë…ë¦½ë³€ìˆ˜ ì •ì˜</code></strong>: <strong><code>ì¡°ê±´</code></strong> ì—ì„œ ì„ ë³„í•œ íŠ¹ì • ë‚ ì§œë¥¼ D0ë¼ê³  í–ˆì„ ë•Œ, D-9, D-8, â€¦, D0, ì´ 10ì¼ ì¹˜ì˜ <code>Open</code>, <code>High</code>, <code>Low</code>, <code>Close</code>, <code>ê±°ë˜ëŒ€ê¸ˆ(trading_value)</code></p></li>
<li><p><strong><code>ì¢…ì†ë³€ìˆ˜ ì •ì˜</code></strong>: ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” íŠ¹ì • ë‚ ì§œ(D0) ëŒ€ë¹„ ë‹¤ìŒë‚ (D+1) ë‚ ì§œì˜ ì¢…ê°€(close)ê°€ 2%ì´ìƒ ìƒìŠ¹í•˜ë©´ <code>1</code>, ìƒìŠ¹í•˜ì§€ ì•Šìœ¼ë©´ <code>0</code></p></li>
<li><p><strong><code>í•™ìŠµ&amp;ì‹œí—˜ ë°ì´í„°ì…‹ ì •ì˜</code></strong></p>
<ul>
<li><p><strong><code>train dataset</code></strong>: 2018ë…„ 1ì›” 2ì¼ - 2020ë…„ 12ì›” 31ì¼ (2ë…„)</p></li>
<li><p><strong><code>test dataset</code></strong>: 2021ë…„ 1ì›” 2ì¼ ~ 2021ë…„ 6ì›” 31ì¼ (6ê°œì›”)</p></li>
</ul></li>
</ul>
<p><br></p>
</section>
<section id="ë°ì´í„°ì…‹-ìƒì„±-ê³¼ì œ" class="level3">
<h3 class="anchored" data-anchor-id="ë°ì´í„°ì…‹-ìƒì„±-ê³¼ì œ">ë°ì´í„°ì…‹ ìƒì„± ê³¼ì œ</h3>
<p>ë°ì´í„°ì…‹ ìƒì„±ì„ 3ë‹¨ê³„ì˜ ê³¼ì •ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
<ul>
<li><p><strong><code>ê³¼ì œ I</code></strong>: ì¢…ëª© ë¦¬ìŠ¤íŠ¸ ìƒì„±-2018ë…„ ë¶€í„° ì¡´ì†í•˜ì˜€ë˜ ê¸°ì—…(ìƒì¥ì¼ 2018ë…„ 1ì›” 1ì¼ ì´ì „ ê¸°ì—…) ì„ ë³„</p></li>
<li><p><strong><code>ê³¼ì œ II</code></strong>: <strong><code>ê³¼ì œI</code></strong> ì˜ ê¸°ì—… ì¤‘ ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒ ë°œìƒí–ˆë˜ íŠ¹ì • ë‚ ì§œ ì„ ë³„ (<code>ê±°ë˜ëŒ€ê¸ˆ</code>=<code>ê±°ë˜ëŸ‰</code>X<code>ì¢…ê°€</code> ë¡œ ê³„ì‚°)</p></li>
<li><p><strong><code>ê³¼ì œ III</code></strong>: <strong><code>ê³¼ì œII</code></strong> ì˜ ë‚ ì§œì— ëŒ€í•´ ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„° ìƒì„±í•˜ì—¬ csv íŒŒì¼ë¡œ ì €ì¥</p></li>
</ul>
<p><br></p>
<p>ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„± ì ˆì°¨ëŠ” <code>df2list</code> - <code>dictionary</code> - <code>MultiProcessing</code> - <code>MySQL</code> ìˆœì„œë¡œ ì§„í–‰í•©ë‹ˆë‹¤. 4ê°€ì§€ ì ˆì°¨ë¥¼ í†µí•´ ë°ì´í„°ì…‹ì´ ë‹¬ë¼ì§€ëŠ” ê²ƒì€ ì•„ë‹ˆê³ , ì†ë„ë¥¼ ê°œì„ ì‹œí‚¤ëŠ” ë°©í–¥ìœ¼ë¡œì˜ íš¨ìœ¨ì ì¸ ì½”ë“œë¥¼ ì§œê¸° ìœ„í•œ í›ˆë ¨ ê³¼ì •ì…ë‹ˆë‹¤. ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì„ ë‹¤ë£¨ê¸° ìœ„í•´ì„œëŠ” íš¨ìœ¨ì ì¸ ì½”ë”©ì„ í†µí•´ ì†ë„ë¥¼ ê°œì„ í•˜ëŠ” ê²ƒë„ ì¤‘ìš”í•œ ì¼ì…ë‹ˆë‹¤. íŠ¹íˆ ì´ë²ˆì— ì‚¬ìš©í•˜ëŠ” ì£¼ê°€ ë°ì´í„°ì…‹ì€ ì–‘ì´ ë§ì„ ë¿ë§Œ ì•„ë‹ˆë¼, <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ì—ì„œ ë¶ˆëŸ¬ì™€ì•¼í•˜ê¸° ë•Œë¬¸ì— ë°ì´í„°ì…‹ì„ êµ¬ì„±í•˜ëŠ” ê²ƒë§Œ í•´ë„ ì†ë„ê°€ ìƒë‹¹íˆ ëŠë¦½ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê³ ì ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” 4ë‹¨ê³„ì— ê±¸ì¹œ ë°ì´í„°ì…‹ ìƒì„± ê³¼ì •ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
<p><br></p>
</section>
<section id="ëª©ì°¨" class="level3">
<h3 class="anchored" data-anchor-id="ëª©ì°¨">ëª©ì°¨</h3>
<ul>
<li><strong>(0)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>DataFrame</code></li>
<li><strong>(1)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>df2list</code></li>
<li><strong>(2)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>dictionary</code></li>
<li><strong>(3)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MultiProcessing</code></li>
<li><strong>(4)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MySQL</code></li>
<li><strong>(5)</strong> ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹</li>
</ul>
</section>
<section id="í•„ìš”-ë¼ì´ë¸ŒëŸ¬ë¦¬-import" class="level3">
<h3 class="anchored" data-anchor-id="í•„ìš”-ë¼ì´ë¸ŒëŸ¬ë¦¬-import">í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ <strong>import</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finance datareader ì„¤ì¹˜ </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ! pip install -U finance-datareader</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> FinanceDataReader <span class="im">as</span> fdr</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ê²½ê³  ë©”ì‹œì§€ ë¬´ì‹œ </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(action<span class="op">=</span><span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br> <br></p>
</section>
</section>
<section id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---dataframe" class="level2">
<h2 class="anchored" data-anchor-id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---dataframe"><strong>(0)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>DataFrame</code></h2>
<p>ì†ë„ ë¹„êµë¥¼ ìœ„í•´ ê¸°ì¡´ ë°ì´í„°ì˜ íƒ€ì…ì¸ <code>DataFrame</code>ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì…‹ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p><strong>ê³¼ì œ I</strong></p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_html(<span class="st">'http://kind.krx.co.kr/corpgeneral/corpList.do?method=download'</span>, header<span class="op">=</span><span class="dv">0</span>)[<span class="dv">0</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># íšŒì‚¬ëª…, ì¢…ëª©ì½”ë“œ, ìƒì¥ì¼ ì»¬ëŸ¼ë§Œ ì‚¬ìš© </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>df_code <span class="op">=</span> df[[<span class="st">'íšŒì‚¬ëª…'</span>, <span class="st">'ì¢…ëª©ì½”ë“œ'</span>, <span class="st">'ìƒì¥ì¼'</span>]]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ì¢…ëª©ì½”ë“œë¥¼ 6ìë¦¬ë¡œ ë§ì¶° ì¤€ë‹¤. </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>df_code[<span class="st">'ì¢…ëª©ì½”ë“œ'</span>] <span class="op">=</span> df_code[<span class="st">'ì¢…ëª©ì½”ë“œ'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : <span class="bu">str</span>(x).zfill(<span class="dv">6</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>display(df_code.head(<span class="dv">3</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ìƒì¥ì¼ì´ 2018ë…„ 1ì›” 1ì¼ ì´ì „ì¸ ì¢…ëª©ì½”ë“œ ì„ ë³„ </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>lst_code <span class="op">=</span> df_code.loc[df_code[<span class="st">'ìƒì¥ì¼'</span>] <span class="op">&lt;</span> <span class="st">'2018-01-01'</span>, <span class="st">'ì¢…ëª©ì½”ë“œ'</span>].to_list()</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ê±¸ë¦° ì‹œê°„: "</span>, time.time() <span class="op">-</span> start_time)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span>, lst_code[:<span class="dv">5</span>])</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(df_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>íšŒì‚¬ëª…</th>
      <th>ì¢…ëª©ì½”ë“œ</th>
      <th>ìƒì¥ì¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>DL</td>
      <td>000210</td>
      <td>1976-02-02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DRBë™ì¼</td>
      <td>004840</td>
      <td>1976-05-21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DSR</td>
      <td>155660</td>
      <td>2013-05-15</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
ê±¸ë¦° ì‹œê°„:  0.0006058216094970703

ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930', '001390']

ì´ 2536 ê°œì˜ ì¢…ëª© ì¤‘ 1972 ê°œì˜ ì¢…ëª© ì„ ë³„</code></pre>
</div>
</div>
<p><strong>ê³¼ì œ II</strong></p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>stock_dict <span class="op">=</span> {}</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(lst_code): </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start<span class="op">=</span><span class="st">'20180101'</span>, end<span class="op">=</span><span class="st">'20201231'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    stock[<span class="st">'trading'</span>] <span class="op">=</span> stock[<span class="st">'Volume'</span>] <span class="op">*</span> stock[<span class="st">'Close'</span>] <span class="co"># ê±°ë˜ëŒ€ê¸ˆ ì»¬ëŸ¼ ì¶”ê°€</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(stock[<span class="st">'trading'</span>] <span class="op">&gt;=</span> <span class="dv">100000000000</span>) <span class="op">&gt;=</span> <span class="dv">1</span>: <span class="co"># ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒì¸ ë°ì´í„°ê°€ í•˜ë‚˜ ì´ìƒ ì¡´ì¬í•˜ë©´</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        stock_dict[code] <span class="op">=</span> stock[stock[<span class="st">'trading'</span>] <span class="op">&gt;=</span> <span class="dv">100000000000</span>].index <span class="co"># index == Date </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(stock_dict)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:58&lt;00:00, 11.08it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš©</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p>ë¨¼ì €, fdrDataReader íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒì¸ ë°ì´í„°ì˜ ë‚ ì§œë¥¼ stock_dictì— stock_dict[code] = [ë‚ ì§œ,â€¦] ì˜ í˜•ì‹ìœ¼ë¡œ ë„£ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ì„ ë³„ëœ ì¢…ëª©ê³¼ ë‚ ì§œë¥¼ lst_code_dateì— ë„£ì–´ì¤€ë‹¤. </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lst_code_date <span class="op">=</span> []</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(stock_dict): </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> date <span class="kw">in</span> (stock_dict[code]):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        lst_code_date.append([code, date])</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ </span><span class="sc">{</span><span class="bu">len</span>(lst_code_date)<span class="sc">}</span><span class="ss">ê°œ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 799/799 [00:00&lt;00:00, 13125.89it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ 14182ê°œ</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p>lst_code_dateì— [ì½”ë“œ, ë‚ ì§œ] í˜•ì‹ìœ¼ë¡œ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.</p>
<p><strong>ê³¼ì œ III</strong></p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> {<span class="st">'code'</span>: [], <span class="st">'d0'</span>: [], <span class="st">'info'</span>: [], <span class="st">'up'</span>: []}</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code, date <span class="kw">in</span> tqdm(lst_code_date):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">'20171201'</span> <span class="co"># 2018ë…„ ì´ˆë°˜ ë‚ ì§œê°€ D0ë¼ë©´ 2017ë…„ ë°ì´í„° í•„ìš” (D-9~D-1)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">'20210130'</span> <span class="co"># 2020ë…„ í›„ë°˜ ë‚ ì§œê°€ D0ë¼ë©´ 2021ë…„ ë°ì´í„° í•„ìš” (D+1) </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start <span class="op">=</span> start_date, end <span class="op">=</span> end_date)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    stock.reset_index(inplace<span class="op">=</span><span class="va">True</span>) <span class="co"># 'Date' index -&gt; column </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    D9_index <span class="op">=</span> stock[stock[<span class="st">'Date'</span>] <span class="op">==</span> <span class="bu">str</span>(date)].index[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">9</span> <span class="co"># D-9 ë‚ ì§œì˜ ì¸ë±ìŠ¤  </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    next_index <span class="op">=</span> stock[stock[<span class="st">'Date'</span>] <span class="op">==</span> <span class="bu">str</span>(date)].index[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span> <span class="co"># D+1 ë‚ ì§œì˜ ì¸ë±ìŠ¤  </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ì¢…ëª©ì½”ë“œ (code)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    data_dict[<span class="st">'code'</span>].append(code) </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ê¸°ì¤€ì¼ (d0)</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    data_dict[<span class="st">'d0'</span>].append(date)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># D-9 ~ D+1, ì´ 11ì¼ì¹˜ì˜ sub stock DataFrame ìƒì„± </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    sub_stock <span class="op">=</span> stock.iloc[D9_index:next_index<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    sub_stock[<span class="st">'trading'</span>] <span class="op">=</span> sub_stock[<span class="st">'Close'</span>] <span class="op">*</span> sub_stock[<span class="st">'Volume'</span>] <span class="co"># ê±°ë˜ëŒ€ê¸ˆ ì»¬ëŸ¼ ì¶”ê°€ </span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 10ì¼ ê°„ì˜ ë°ì´í„° (info)</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    info_list <span class="op">=</span> []</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):        </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        info_list.append(sub_stock.iloc[i, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>]].to_list())</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    remove_list<span class="op">=</span>[<span class="st">'['</span>, <span class="st">']'</span>]</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>): </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        info_list <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>info_list<span class="sc">}</span><span class="ss">'</span>.replace(remove_list[i], <span class="st">''</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    data_dict[<span class="st">'info'</span>].append(info_list)    </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up)</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    up <span class="op">=</span> sub_stock.iloc[<span class="op">-</span><span class="dv">2</span>][<span class="st">'Close'</span>] <span class="op">+</span> <span class="fl">0.02</span> <span class="op">*</span> sub_stock.iloc[<span class="op">-</span><span class="dv">2</span>][<span class="st">'Close'</span>]</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sub_stock.iloc[<span class="op">-</span><span class="dv">1</span>][<span class="st">'Close'</span>] <span class="op">&gt;=</span> up: </span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        data_dict[<span class="st">'up'</span>].append(<span class="dv">1</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        data_dict[<span class="st">'up'</span>].append(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14182/14182 [17:08&lt;00:00, 13.78it/s]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_result <span class="op">=</span> pd.DataFrame(data_dict)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>display(df_result.head()) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ìµœì¢… ê²°ê³¼ ë°ì´í„°ì…‹ txt íŒŒì¼ ì €ì¥ </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>df_result.to_csv(<span class="st">"assignment3.txt"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="sc">{</span><span class="bu">len</span>(pd.read_csv(<span class="st">"assignment3.txt"</span>))<span class="sc">}</span><span class="ss"> ê°œ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>code</th>
      <th>d0</th>
      <th>info</th>
      <th>up</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000210</td>
      <td>2018-01-26</td>
      <td>78343, 78614, 76987, 77892, 9590608284, 77801,...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000210</td>
      <td>2018-08-08</td>
      <td>68855, 69397, 67590, 69036, 6067435968, 69487,...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000210</td>
      <td>2020-04-02</td>
      <td>44819, 52951, 44322, 51145, 15615437965, 47439...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000210</td>
      <td>2020-09-11</td>
      <td>80783, 84487, 78524, 78524, 61554885076, 79608...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000210</td>
      <td>2020-12-11</td>
      <td>76174, 76174, 72289, 72289, 76043112348, 72831...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 14182 ê°œ</code></pre>
</div>
</div>
<p><br></p>
<p>ìµœì¢…ì ìœ¼ë¡œ ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµì„ ìœ„í•œ ë°ì´í„°ì…‹ì„ ì²˜ë¦¬í•˜ëŠ” ì½”ë“œëŠ” ì´ 17ë¶„ì´ ê±¸ë ¸ìŠµë‹ˆë‹¤. ì—°êµ¬ ì´ˆë°˜ì— ê°€ì¥ ì²« ë²ˆì§¸ë¡œ ì‘ì„±í•œ ì½”ë“œì¸ë°, ì§€ê¸ˆ ë³´ë‹ˆ í™•ì‹¤íˆ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ì‘ì„±í–ˆë˜ ë¶€ë¶„ì´ ë§ì€ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
<p><br></p>
<p><strong>ê°œì„ í•´ì•¼í•  ì‚¬í•­</strong></p>
<ul>
<li><p><strong><code>ì†ë„ ê°œì„ </code></strong>: <strong><code>ê³¼ì œIII</code></strong> ì€ ì•½ 17ë¶„ì´ ê±¸ë¦° ê²ƒì„ ë³´ì•„ ì†ë„ ë©´ì—ì„œ ìƒë‹¹íˆ ë¹„íš¨ìœ¨ì ì´ì—ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê±°ë˜ëŒ€ê¸ˆì„ 10ì–µìœ¼ë¡œ ì„¤ì •í–ˆì„ ë•Œ 1% ì§„í–‰ì— 5ë¶„ì´ ê±¸ë ¸ìŠµë‹ˆë‹¤. ê·¸ëŸ¼ ì´ 500ë¶„ì´ ê±¸ë¦´ ê²ƒìœ¼ë¡œ ì˜ˆìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)</p></li>
<li><p><strong><code># 10ì¼ ê°„ì˜ ë°ì´í„°</code></strong> ë¶€ë¶„: <code>info_list</code>ì— ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì—ì„œ ì–µì§€ë¡œ í¬ë§·ì„ ë§ì¶”ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•œ <code>forë¬¸</code>ì´ ë“¤ì–´ê°”ìŠµë‹ˆë‹¤.</p></li>
<li><p><strong><code># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€</code></strong> ë¶€ë¶„: ì „ ë‚  ëŒ€ë¹„ 2% ìƒìŠ¹ìœ¨ì„ ì§ì ‘ ê³„ì‚°í•´ ì£¼ì—ˆëŠ”ë°, ì´ë¯¸ ë³€í™”ìœ¨ì´ ê³„ì‚° ë˜ì–´ ìˆëŠ” <code>change</code>ë¼ëŠ” ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.</p></li>
<li><p><strong><code>txt íŒŒì¼ ì €ì¥</code></strong>: <code>DataFrame</code>ìœ¼ë¡œ ìƒì„±ì„ í•œ í›„ì— <code>txt</code> íŒŒì¼ë¡œ ì €ì¥í–ˆëŠ”ë°, ë°ì´í„° ìƒì„± ì‹œ íŒŒì¼ ì…ì¶œë ¥ <code>write()</code>ë¥¼ ì‚¬ìš©í•´ì„œ ë°”ë¡œ <code>txt</code> íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.</p></li>
</ul>
<hr>
<p><br> <br></p>
</section>
<section id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---df2list" class="level2">
<h2 class="anchored" data-anchor-id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---df2list">(1) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>df2list</code></h2>
<p>ì²«ë²ˆì§¸ ë°©ë²•ì€ <code>DataFrame</code> ì‚¬ìš©ì„ ì§€ì–‘í•˜ê³ , <code>python</code>ì˜ ê¸°ë³¸ ë°ì´í„° íƒ€ì…ì¸ <code>list</code>ë¡œ ë°”ê¾¸ì–´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ë¡œì¨ <code>column</code> ì¤‘ì‹¬ì˜ ì—°ì‚°ì„ <code>row</code> ì¤‘ì‹¬ì˜ ì—°ì‚°ìœ¼ë¡œ ë°”ê¾¸ì–´ì¤ë‹ˆë‹¤. ì´ ë°©ë²•ì—ì„œëŠ” ì†ë„ ê°œì„  ë³´ë‹¤ëŠ” <code>(0)</code>ë²ˆ ë°©ë²•ì˜ ì½”ë“œì—ì„œ íš¨ìœ¨ì ì´ì§€ ëª»í–ˆë˜ ë¶€ë¶„ì„ ê³ ì¹˜ê³  ê¹”ë”í•œ ì½”ë“œë¡œ ë³´ì™„í•©ë‹ˆë‹¤.</p>
<p><strong>ê³¼ì œ I</strong></p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (0) ë°©ë²•ì—ì„œ ì‚¬ìš©í–ˆë˜ df_code ë°ì´í„° í”„ë ˆì„ ì‚¬ìš© </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>display(df_code.head(<span class="dv">2</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ğŸŒŸ dataframe -&gt; list </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>lst_stock <span class="op">=</span> df_code.values.tolist()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lst_stock[:<span class="dv">2</span>])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>lst_code <span class="op">=</span> [] <span class="co"># ì„ ë³„ ëœ ì½”ë“œë¥¼ ë‹´ì„ ë¦¬ìŠ¤íŠ¸ </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> lst_stock:</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    code, date <span class="op">=</span> row[<span class="dv">1</span>], row[<span class="dv">2</span>]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> date <span class="op">&lt;=</span> <span class="st">'2018-01-01'</span>:</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        lst_code.append(code)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ê±¸ë¦° ì‹œê°„: "</span>, time.time() <span class="op">-</span> start_time)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span>, lst_code[:<span class="dv">4</span>])</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(df_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>íšŒì‚¬ëª…</th>
      <th>ì¢…ëª©ì½”ë“œ</th>
      <th>ìƒì¥ì¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>DL</td>
      <td>000210</td>
      <td>1976-02-02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DRBë™ì¼</td>
      <td>004840</td>
      <td>1976-05-21</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[['DL', '000210', '1976-02-02'], ['DRBë™ì¼', '004840', '1976-05-21']]

ê±¸ë¦° ì‹œê°„:  0.0004563331604003906

ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930']

ì´ 2536 ê°œì˜ ì¢…ëª© ì¤‘ 1972 ê°œì˜ ì¢…ëª© ì„ ë³„</code></pre>
</div>
</div>
<p><strong>ê³¼ì œ II</strong></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lst_code_date <span class="op">=</span> []</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(lst_code):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start<span class="op">=</span><span class="st">'20180102'</span>, end<span class="op">=</span><span class="st">'20201231'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    stock.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> lst_stock: </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        date, trading_value <span class="op">=</span> row[<span class="dv">0</span>], row[<span class="dv">4</span>]<span class="op">*</span>row[<span class="dv">5</span>]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> trading_value <span class="op">&gt;=</span> <span class="dv">100000000000</span>:  <span class="co"># ê±°ë˜ëŒ€ê¸ˆ 1000ì–µ ì´ìƒ</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>            lst_code_date.append([code, date.date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>)])</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ </span><span class="sc">{</span><span class="bu">len</span>(lst_code_date)<span class="sc">}</span><span class="ss">ê°œ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:55&lt;00:00, 11.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ 14182ê°œ</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p><strong>ê³¼ì œ III</strong></p>
<div class="cell" data-scrolled="true" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>OF <span class="op">=</span> <span class="bu">open</span>(<span class="st">'assignment3.txt'</span>,<span class="st">'w'</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code, date <span class="kw">in</span> tqdm(lst_code_date):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">'20180101'</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">'20201231'</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start <span class="op">=</span> start_date, end <span class="op">=</span> end_date)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    stock.reset_index(inplace<span class="op">=</span><span class="va">True</span>) <span class="co"># 'Date' index -&gt; column </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list </span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, row <span class="kw">in</span> <span class="bu">enumerate</span>(lst_stock): </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (idx <span class="op">&lt;</span> <span class="dv">9</span>) <span class="kw">or</span> (idx <span class="op">&gt;=</span> <span class="bu">len</span>(lst_stock)<span class="op">-</span><span class="dv">1</span>): <span class="co"># ì˜ˆì™¸ ì²˜ë¦¬ </span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> row[<span class="dv">0</span>].date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>) <span class="op">==</span> date: </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>            <span class="co"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>            sub_stock <span class="op">=</span> lst_stock[idx<span class="op">-</span><span class="dv">9</span>:idx<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 10ì¼ ê°„ì˜ ë°ì´í„° </span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>            lst_info <span class="op">=</span> []</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> row2 <span class="kw">in</span> sub_stock:</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                lst_prices, trading_value <span class="op">=</span> row2[<span class="dv">1</span>:<span class="dv">5</span>], row[<span class="dv">4</span>]<span class="op">*</span>row[<span class="dv">5</span>]</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>                lst_info <span class="op">+=</span> lst_prices <span class="op">+</span> [trading_value]</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>            info <span class="op">=</span> <span class="st">','</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, lst_info))</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up)</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>            change <span class="op">=</span> lst_stock[idx<span class="op">+</span><span class="dv">1</span>][<span class="dv">6</span>]</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>            label <span class="op">=</span> <span class="bu">int</span>(change <span class="op">&gt;=</span> <span class="fl">0.02</span>)</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># ì €ì¥ </span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>            OF.write(<span class="ss">f'</span><span class="sc">{</span>code<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>date<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>lst_info<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>label<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>OF.close()</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="sc">{</span><span class="bu">len</span>(pd.read_csv(<span class="st">"assignment3.txt"</span>))<span class="sc">}</span><span class="ss"> ê°œ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14182/14182 [17:43&lt;00:00, 13.33it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<ul>
<li><p><code>OF.write()</code>ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë¸”í•„ìš”í•œ <code>DataFrame</code> ì„ ìƒì„±í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p></li>
<li><p><strong># 10ì¼ê°„ì˜ ë°ì´í„°</strong> ë¶€ë¶„ì€ <code>join()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶ˆí•„ìš”í•œ forë¬¸ ì‚¬ìš©ì„ ì¤„ì˜€ê³ , <strong># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up)</strong> ë¶€ë¶„ì€ ì „ë‚  ëŒ€ë¹„ ì¢…ê°€ ë³€í™”ìœ¨ì„ ê³„ì‚°í•˜ì§€ ì•Šê³  <code>change</code> ì»¬ëŸ¼ì„ í™œìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ë°”ê¾¸ì—ˆìŠµë‹ˆë‹¤.</p></li>
<li><p><strong><code>ì†ë„ì— ëŒ€í•œ ë¬¸ì œì </code></strong> : ì „ ë³´ë‹¤ ê¹”ë”í•œ ì½”ë“œë¡œ ë³´ì™„ì´ ë˜ì—ˆì§€ë§Œ, ì•„ì§ ì†ë„ì— ëŒ€í•œ ë¬¸ì œì ì´ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤. ì†ë„ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ì„œëŠ” <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìµœì†Œí•œìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì§€ê¸ˆ [ì½”ë“œ, ë‚ ì§œ]ì˜ í˜•íƒœë¡œ forë¬¸ì´ ëŒê³ ìˆê¸° ë•Œë¬¸ì—, ì¤‘ë³µë˜ëŠ” ê°™ì€ Codeë¥¼ ì—¬ëŸ¬ ë²ˆ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ lst_code_date ë¦¬ìŠ¤íŠ¸ ëŒ€ì‹ , <code>dictionary</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.</p></li>
</ul>
<hr>
<p><br> <br></p>
</section>
<section id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---dictionary" class="level2">
<h2 class="anchored" data-anchor-id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---dictionary">(2) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>dictionary</code></h2>
<p><code>dictionary</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ <strong><code>ê³¼ì œIII</code></strong> ì˜ ì†ë„ë¥¼ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìµœì†Œí•œìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , <code>for</code>ë¬¸ì„ ìµœëŒ€í•œ ì¤„ì…ë‹ˆë‹¤. í˜„ì¬ ë¬¸ì œì ì€ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ <code>for</code>ë¬¸ì´ ëŒì•„ê°€ê¸° ë•Œë¬¸ì— ê°™ì€ ë°ì´í„°(ê°™ì€ ì¢…ëª©)ê°€ ì—¬ëŸ¬ë²ˆ ë¶ˆëŸ¬ì™€ì§€ëŠ” ê²½ìš°ê°€ ë‹¤ìˆ˜ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ <strong><code>ê³¼ì œII</code></strong> ì—ì„œ <code>code</code>ë³„ <code>D0</code> ë‚ ì§œ ë¦¬ìŠ¤íŠ¸ë¥¼ <code>dictionary</code> íƒ€ì…ìœ¼ë¡œ ìƒì„±í•˜ê³ , <strong><code>ê³¼ì œIII</code></strong> ì—ì„œ <code>code</code> ë‹¹ í•œë²ˆë§Œ <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë°”ê¾¸ì–´ ì¤ë‹ˆë‹¤.</p>
<p><strong>ê³¼ì œ I</strong></p>
<p><strong><code>ê³¼ì œI</code></strong> ì€ ì•ì˜ ë°©ë²•ê³¼ ê°™ìœ¼ë¯€ë¡œ ìƒëµí•©ë‹ˆë‹¤.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span>, lst_code[:<span class="dv">4</span>])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(df_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930']

ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„</code></pre>
</div>
</div>
<p><strong>ê³¼ì œ II</strong></p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dict_code2date <span class="op">=</span> {}</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(lst_code): </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">'20180102'</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">'20201231'</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start <span class="op">=</span> start_date, end <span class="op">=</span> end_date)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    stock.reset_index(inplace<span class="op">=</span><span class="va">True</span>)    </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list     </span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> lst_stock: </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        date, trading_value <span class="op">=</span> row[<span class="dv">0</span>], row[<span class="dv">4</span>]<span class="op">*</span>row[<span class="dv">5</span>]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> trading_value <span class="op">&gt;=</span> <span class="dv">100000000000</span>:</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> code <span class="kw">not</span> <span class="kw">in</span> dict_code2date.keys():</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                dict_code2date[code] <span class="op">=</span> [date.date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>)]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                dict_code2date[code].append(date.date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>))</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(dict_code2date)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:42&lt;00:00, 12.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš©</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p><strong>ê³¼ì œ III</strong></p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>OF <span class="op">=</span> <span class="bu">open</span>(<span class="st">'assignment3.txt'</span>, <span class="st">'w'</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(dict_code2date): </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># codeì˜ stock </span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">'20180101'</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">'20201231'</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start <span class="op">=</span> start_date, end <span class="op">=</span> end_date)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    stock.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list     </span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()  </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, row <span class="kw">in</span> <span class="bu">enumerate</span>(lst_stock):   </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (idx <span class="op">&lt;</span> <span class="dv">9</span>) <span class="kw">or</span> (idx <span class="op">&gt;=</span> <span class="bu">len</span>(lst_stock)<span class="op">-</span><span class="dv">1</span>): <span class="co"># ì˜ˆì™¸ ì²˜ë¦¬ </span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        date <span class="op">=</span> row[<span class="dv">0</span>].date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>) </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> date <span class="kw">not</span> <span class="kw">in</span> dict_code2date[code]: <span class="co"># ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        sub_stock <span class="op">=</span> lst_stock[idx<span class="op">-</span><span class="dv">9</span>:idx<span class="op">+</span><span class="dv">1</span>] </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 10ì¼ê°„ì˜ ë°ì´í„° </span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        lst_info <span class="op">=</span> []</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row2 <span class="kw">in</span> sub_stock:</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>            lst_prices, trading_value <span class="op">=</span> row2[<span class="dv">1</span>:<span class="dv">5</span>], row2[<span class="dv">4</span>]<span class="op">*</span>row2[<span class="dv">5</span>]</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>            lst_info <span class="op">+=</span> lst_prices <span class="op">+</span> [trading_value]</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        info <span class="op">=</span> <span class="st">','</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, lst_info))</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ </span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> <span class="bu">int</span>(lst_stock[idx<span class="op">+</span><span class="dv">1</span>][<span class="dv">6</span>] <span class="op">&gt;=</span> <span class="fl">0.02</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ì €ì¥ </span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>        OF.write(<span class="ss">f'</span><span class="sc">{</span>code<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>date<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>info<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>label<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>OF.close()   </span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="sc">{</span><span class="bu">len</span>(pd.read_csv(<span class="st">"assignment3.txt"</span>))<span class="sc">}</span><span class="ss"> ê°œ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 799/799 [01:07&lt;00:00, 11.84it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p>ë‚ ì§œ ì¤‘ì‹¬ì˜ forë¬¸ì„ ì½”ë“œ ì¤‘ì‹¬ìœ¼ë¡œ ë³€ê²½í•¨ìœ¼ë¡œì¨ fdr ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì„ ìµœì†Œí™”í•˜ì—¬, ì•½ 17ë¶„ì´ ê±¸ë¦¬ë˜ ì‹œê°„ì´ 1ë¶„ìœ¼ë¡œ ëŒ€í­ ì¤„ì–´ë“  ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<hr>
<p><br> <br></p>
</section>
<section id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---multiprocessing" class="level2">
<h2 class="anchored" data-anchor-id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---multiprocessing">(3) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MultiProcessing</code></h2>
<ul>
<li><p><code>multi processing(ë‹¤ì¤‘ ì²˜ë¦¬)</code>: ì»´í“¨í„° ì‹œìŠ¤í…œ í•œ ëŒ€ì— ë‘ê°œ ì´ìƒì˜ ì¤‘ì•™ ì²˜ë¦¬ ì¥ì¹˜ (CPU) ë¥¼ ì´ìš©í•˜ì—¬ ë³‘ë ¬ì²˜ë¦¬í•˜ëŠ” ê²ƒ</p></li>
<li><p><code>python multi processing</code> ë¬¸ì„œ: <a href="https://docs.python.org/ko/3/library/multiprocessing.html">https://docs.python.org/ko/3/library/multiprocessing.html</a>.</p></li>
</ul>
<p><code>python</code>ì€ <code>multiprocessing</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ë‹¤ì¤‘ ì²˜ë¦¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ê°œì˜ <code>ì½”ì–´</code>ë¥¼ ì—°ì‚°ì— ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë§ì€ ì‘ì—…ì„ ë¹ ë¥¸ ì‹œê°„ì— ì²˜ë¦¬í•´ì¤„ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="01.stock_dataset_files/figure-html/0ffe5b3b-1-2f0f318d-7916-4680-a2ef-1fcd59b168fc.png" class="img-fluid" alt="image.png"> [ <code>core=10</code>ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ multi processingì„ ìˆ˜í–‰í•  ë•Œ ì½”ì–´ ì‚¬ìš© ]</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MultiProcessingì„ ìœ„í•œ library import </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time, os</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> multiprocessing <span class="im">import</span> Pool</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>ê³¼ì œ I</strong></p>
<p><strong><code>ê³¼ì œI</code></strong> ì€ ì•ì˜ ë°©ë²•ê³¼ ê°™ìœ¼ë¯€ë¡œ ìƒëµí•©ë‹ˆë‹¤.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span>, lst_code[:<span class="dv">4</span>])</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(df_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930']

ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„</code></pre>
</div>
</div>
<p><strong>ê³¼ì œ II</strong></p>
<ul>
<li><code>multi processing</code>ì„ ìœ„í•œ í•¨ìˆ˜ ì •ì˜</li>
</ul>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_lst_result(code): </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">'20180101'</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">'20201231'</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    lst_date <span class="op">=</span> []</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start <span class="op">=</span> start_date, end <span class="op">=</span> end_date)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    stock.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> lst_stock: </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> row[<span class="dv">4</span>] <span class="op">*</span> row[<span class="dv">5</span>] <span class="op">&gt;=</span> <span class="dv">100000000000</span>: </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>            lst_date.append(row[<span class="dv">0</span>].date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>))</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [code, lst_date]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>multi processing</code> ìˆ˜í–‰</li>
</ul>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>pool <span class="op">=</span> Pool(num_cores)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>lst_code_date <span class="op">=</span> pool.<span class="bu">map</span>(make_lst_result, lst_code)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>pool.close()</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>pool.join()</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(time.time() <span class="op">-</span> start_time) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>17.97966194152832</code></pre>
</div>
</div>
<p>ì•ì„œ ì•½ 2ë¶„ 40ì´ˆ ê°€ ê±¸ë ¸ë˜ <strong><code>ê³¼ì œII</code></strong> ë¥¼ <code>multi processing</code>ì„ ì‚¬ìš©í•˜ì—¬ 17ì´ˆëŒ€ë¡œ ë‹¨ì¶•ì‹œì¼°ìŠµë‹ˆë‹¤.</p>
<ul>
<li><code>dictionary</code> ìƒì„±</li>
</ul>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dict_code2date <span class="op">=</span> {}</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code, lst_date  <span class="kw">in</span> tqdm(lst_code_date):</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> lst_date <span class="op">==</span> []:</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    dict_code2date[code] <span class="op">=</span> lst_date</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(dict_code2date)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [00:00&lt;00:00, 1610124.08it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš©</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p><strong>ê³¼ì œ III</strong></p>
<ul>
<li><code>multi processing</code>ì„ ìœ„í•œ í•¨ìˆ˜ ì •ì˜</li>
</ul>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_lst_result2(code): </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># codeì˜ stock </span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">'20180101'</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">'20201231'</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start <span class="op">=</span> start_date, end <span class="op">=</span> end_date)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    stock.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list     </span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()  </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    lst_result <span class="op">=</span> []</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, row <span class="kw">in</span> <span class="bu">enumerate</span>(lst_stock): </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (idx <span class="op">&lt;</span> <span class="dv">9</span>) <span class="kw">or</span> (idx <span class="op">&gt;=</span> <span class="bu">len</span>(lst_stock)<span class="op">-</span><span class="dv">1</span>): <span class="co"># ì˜ˆì™¸ ì²˜ë¦¬ </span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>        date <span class="op">=</span> row[<span class="dv">0</span>].date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>) </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> date <span class="kw">not</span> <span class="kw">in</span> dict_code2date[code]: <span class="co"># ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>        sub_stock <span class="op">=</span> lst_stock[idx<span class="op">-</span><span class="dv">9</span>:idx<span class="op">+</span><span class="dv">1</span>] </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 10ì¼ê°„ì˜ ë°ì´í„° </span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        lst_info <span class="op">=</span> []</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row2 <span class="kw">in</span> sub_stock:</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>            lst_prices, trading_value <span class="op">=</span> row2[<span class="dv">1</span>:<span class="dv">5</span>], row2[<span class="dv">4</span>]<span class="op">*</span>row2[<span class="dv">5</span>]</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>            lst_info <span class="op">+=</span> lst_prices <span class="op">+</span> [trading_value]</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>        info <span class="op">=</span> <span class="st">','</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, lst_info))</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ </span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> <span class="bu">int</span>(lst_stock[idx<span class="op">+</span><span class="dv">1</span>][<span class="dv">6</span>] <span class="op">&gt;=</span> <span class="fl">0.02</span>)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>        lst_result.append([code, date, info, label])</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lst_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>multi processing</code> ìˆ˜í–‰</li>
</ul>
<div class="cell" data-scrolled="true" data-execution_count="26">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>pool <span class="op">=</span> Pool(num_cores)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>lst_data <span class="op">=</span> pool.<span class="bu">map</span>(make_lst_result2, dict_code2date.keys())</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>pool.close()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>pool.join()</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(time.time() <span class="op">-</span> start_time) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>8.186521768569946</code></pre>
</div>
</div>
<p>ì•ì„œ ì§„í–‰í–ˆë˜ ë°©ë²•ì—ì„œ 1ë¶„ì´ ê±¸ë ¸ë˜ ì‘ì—…ì´ <code>multi processing</code>ì„ ì‚¬ìš©í•˜ì—¬ 8ì´ˆë¡œ ì¤„ì–´ë“¤ì—ˆìŠµë‹ˆë‹¤.</p>
<ul>
<li><code>txt</code> íŒŒì¼ ìƒì„±</li>
</ul>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>OF <span class="op">=</span> <span class="bu">open</span>(<span class="st">"assignment3_multi_processing.txt"</span>, <span class="st">'w'</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> lst_data: </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(row)): </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        OF.write(<span class="st">'</span><span class="ch">\t</span><span class="st">'</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, row[num])) <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>OF.close()</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="sc">{</span><span class="bu">len</span>(pd.read_csv(<span class="st">"assignment3_multi_processing.txt"</span>))<span class="sc">}</span><span class="ss"> ê°œ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ</code></pre>
</div>
</div>
<hr>
<p><br> <br></p>
<section id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---mysql" class="level3">
<h3 class="anchored" data-anchor-id="finance-data-readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---mysql"><strong>(4)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MySQL</code></h3>
<p>4ë²ˆì§¸ ë°©ë²•ì€ <code>MySQL</code>ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì™¸ë¶€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•„ë„ ë˜ê³ , ì„œë²„ <code>DB</code>ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì´ë¯€ë¡œ <code>multi processing</code>ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ë¹ ë¥¸ ì†ë„ë¡œ ë°ì´í„°ì…‹ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><strong>ê³¼ì œ I</strong></p>
<p>ìµœì¢…ì ìœ¼ë¡œ ë¨¸ì‹ ëŸ¬ë‹ ë¶„ì„ì— ì‚¬ìš©í•  ë°ì´í„°ì…‹ì€ ì½”ìŠ¤í”¼, ì½”ìŠ¤ë‹¥ ì‹œì¥ì— í•´ë‹¹í•˜ëŠ” ì¢…ëª©ë“¤ë§Œì„ ì‚¬ìš©í•©ë‹ˆë‹¤. í˜„ì¬ <code>db</code>ì— ì €ì¥ë˜ì–´ ìˆëŠ” ë°ì´í„°ë„ ì½”ìŠ¤í”¼, ì½”ìŠ¤ë‹¥ ì‹œì¥ì— í•´ë‹¹í•˜ëŠ” ì¢…ëª©ë“¤ì´ ì…ë ¥ë˜ì–´ ìˆìœ¼ë©°, í•´ë‹¹ ì¢…ëª©ë“¤ì„ ì¶”ë¦° <code>code_list.txt</code>ì—ì„œ ì¢…ëª©ë“¤ì„ ë¶ˆëŸ¬ì™€ <code>lst_code</code>ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>IF <span class="op">=</span> <span class="bu">open</span>(<span class="st">'../data/code_list.txt'</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>lst_code <span class="op">=</span> IF.readlines()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(df_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ì´ 2536 ê°œì˜ ì¢…ëª© ì¤‘ 1561 ê°œì˜ ì¢…ëª© ì„ ë³„</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pymysql ì„¤ì¹˜</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ! pip install pymysql</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymysql </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><code>MySQL</code> ë°ì´í„° ì €ì¥</strong> (<code>dataframe</code> -&gt; <code>sql</code>) <br></li>
</ul>
<p><code>code</code> ë³„ë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ì— ì €ì¥í•©ë‹ˆë‹¤.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>db_connection_str <span class="op">=</span> <span class="st">'mysql+pymysql://[db username]:[db password]@[host address]/[db name]'</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>db_connection <span class="op">=</span> create_engine(db_connection_str)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> db_connection.<span class="ex">connect</span>()</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(lst_code): </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> <span class="st">'20170101'</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> <span class="st">'20211231'</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> fdr.DataReader(code, start <span class="op">=</span> start_date, end <span class="op">=</span> end_date)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> stock.reset_index()</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> stock[[<span class="st">'Date'</span>, <span class="st">'Open'</span>, <span class="st">'High'</span>, <span class="st">'Low'</span>, <span class="st">'Close'</span>, <span class="st">'Volume'</span>, <span class="st">'Change'</span>]]</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    stock.to_sql(name<span class="op">=</span><span class="ss">f'stock_</span><span class="sc">{</span>code<span class="sc">}</span><span class="ss">'</span>, con<span class="op">=</span>db_connection, if_exists<span class="op">=</span><span class="st">'fail'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><code>MySQL</code> ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¨ í›„ ë°ì´í„°ì…‹ ìƒì„±</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>db_dsml <span class="op">=</span> pymysql.<span class="ex">connect</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    host <span class="op">=</span> <span class="st">'localhost'</span>, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    port <span class="op">=</span> <span class="dv">3306</span>, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    user <span class="op">=</span> <span class="st">'[db username]'</span>, </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    passwd <span class="op">=</span> <span class="st">'[db password]'</span>, </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> <span class="st">'[db name]'</span>, </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    charset <span class="op">=</span> <span class="st">'utf8'</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> db_dsml.cursor()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>ê³¼ì œ II</strong></p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>dict_code2date <span class="op">=</span> {}</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(lst_code): </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    code <span class="op">=</span> code.strip()</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    sql_query <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="st">                SELECT *</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="st">                FROM stock_</span><span class="sc">{}</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="st">                WHERE Date BETWEEN '2018-01-01' AND '2020-12-31'</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="st">                '''</span>.<span class="bu">format</span>(code)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> pd.read_sql(sql <span class="op">=</span> sql_query, con <span class="op">=</span> db_dsml)   </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list     </span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> lst_stock: </span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>        date, trading_value <span class="op">=</span> row[<span class="dv">0</span>], row[<span class="dv">4</span>]<span class="op">*</span>row[<span class="dv">5</span>]</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> trading_value <span class="op">&gt;=</span> <span class="dv">100000000000</span>:</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> code <span class="kw">not</span> <span class="kw">in</span> dict_code2date.keys():</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>                dict_code2date[code] <span class="op">=</span> [date.date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>)]</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>                dict_code2date[code].append(date.date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>))</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ì´ </span><span class="sc">{</span><span class="bu">len</span>(lst_code)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="sc">{</span><span class="bu">len</span>(dict_code2date)<span class="sc">}</span><span class="ss"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1561/1561 [00:18&lt;00:00, 82.67it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ì´ 1561 ê°œì˜ ì¢…ëª© ì¤‘ 679 ê°œì˜ ì¢…ëª© ì‚¬ìš©</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p><strong>ê³¼ì œ III</strong></p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>OF <span class="op">=</span> <span class="bu">open</span>(<span class="st">'assignment3_sql.txt'</span>, <span class="st">'w'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> code <span class="kw">in</span> tqdm(dict_code2date): </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    code <span class="op">=</span> code.strip()</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    sql_query <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="st">                SELECT *</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="st">                FROM stock_</span><span class="sc">{}</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="st">                WHERE Date BETWEEN '2018-01-01' AND '2020-12-31'</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="st">                '''</span>.<span class="bu">format</span>(code)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    stock <span class="op">=</span> pd.read_sql(sql <span class="op">=</span> sql_query, con <span class="op">=</span> db_dsml)  </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ğŸŒŸ dataframe -&gt; list     </span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    lst_stock <span class="op">=</span> stock.values.tolist()  </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, row <span class="kw">in</span> <span class="bu">enumerate</span>(lst_stock):   </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (idx <span class="op">&lt;</span> <span class="dv">9</span>) <span class="kw">or</span> (idx <span class="op">&gt;=</span> <span class="bu">len</span>(lst_stock)<span class="op">-</span><span class="dv">1</span>): <span class="co"># ì˜ˆì™¸ ì²˜ë¦¬ </span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>        date <span class="op">=</span> row[<span class="dv">0</span>].date().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">"</span>) </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> date <span class="kw">not</span> <span class="kw">in</span> dict_code2date[code]: <span class="co"># ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>        sub_stock <span class="op">=</span> lst_stock[idx<span class="op">-</span><span class="dv">9</span>:idx<span class="op">+</span><span class="dv">1</span>] </span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 10ì¼ê°„ì˜ ë°ì´í„° </span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>        lst_info <span class="op">=</span> []</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row2 <span class="kw">in</span> sub_stock:</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>            lst_prices, trading_value <span class="op">=</span> row2[<span class="dv">1</span>:<span class="dv">5</span>], row2[<span class="dv">4</span>]<span class="op">*</span>row2[<span class="dv">5</span>]</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>            lst_info <span class="op">+=</span> lst_prices <span class="op">+</span> [trading_value]</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>        info <span class="op">=</span> <span class="st">','</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, lst_info))</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ </span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> <span class="bu">int</span>(lst_stock[idx<span class="op">+</span><span class="dv">1</span>][<span class="dv">6</span>] <span class="op">&gt;=</span> <span class="fl">0.02</span>)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ì €ì¥ </span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>        OF.write(<span class="ss">f'</span><span class="sc">{</span>code<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>date<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>info<span class="sc">}</span><span class="ch">\t</span><span class="sc">{</span>label<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame()</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>OF.close()   </span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="sc">{</span><span class="bu">len</span>(pd.read_csv(<span class="st">"assignment3_sql.txt"</span>))<span class="sc">}</span><span class="ss"> ê°œ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 679/679 [00:09&lt;00:00, 72.67it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 11934 ê°œ</code></pre>
</div>
</div>
<p>MySQLì—ì„œ ì½”ë“œë³„ë¡œ ì €ì¥ë˜ì–´ìˆëŠ” ë°ì´í„°ì…‹ì„ ë¶ˆëŸ¬ì™€ 9ì´ˆì˜ ì‹œê°„ì´ ê±¸ë ¸ìŠµë‹ˆë‹¤. multiprocessingìœ¼ë¡œ ì½”ì–´ë¥¼ ì—¬ëŸ¬ê°œ ì“´ ê²ƒê³¼ ë¹„ìŠ·í•œ ê²°ê³¼ê°€ ë‚˜ì˜¨ ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
<hr>
<p><br> <br></p>
</section>
<section id="ìµœì¢…-ë¨¸ì‹ ëŸ¬ë‹-ë°ì´í„°ì…‹" class="level3">
<h3 class="anchored" data-anchor-id="ìµœì¢…-ë¨¸ì‹ ëŸ¬ë‹-ë°ì´í„°ì…‹"><strong>(5)</strong> ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹</h3>
<p>ìµœì¢…ì ìœ¼ë¡œ ìƒì„±ëœ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì˜ í˜•íƒœë¥¼ í™•ì¸í•œë‹¤.</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>IF<span class="op">=</span><span class="bu">open</span>(<span class="st">"assignment3_sql.txt"</span>,<span class="st">'r'</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>lst_code_date<span class="op">=</span>[]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>trainX<span class="op">=</span>[]</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>trainY<span class="op">=</span>[]</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> IF:</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    code, date, x, y <span class="op">=</span> line.strip().split(<span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    lst_code_date.append([code, date])</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    trainX.append(<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, x.split(<span class="st">","</span>))))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    trainY.append(<span class="bu">int</span>(y))</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>trainX<span class="op">=</span>pd.DataFrame(trainX)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>trainY<span class="op">=</span>pd.DataFrame(trainY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"===== trainX ====="</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"trainX shape:"</span>, trainX.shape)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>display(trainX.head())</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"===== trainY ====="</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"trainY shape:"</span>, trainY.shape)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>display(trainY.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>===== trainX =====
trainX shape: (11935, 50)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>40</th>
      <th>41</th>
      <th>42</th>
      <th>43</th>
      <th>44</th>
      <th>45</th>
      <th>46</th>
      <th>47</th>
      <th>48</th>
      <th>49</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10250</td>
      <td>12050</td>
      <td>10150</td>
      <td>11800</td>
      <td>307823874200</td>
      <td>11950</td>
      <td>12450</td>
      <td>10900</td>
      <td>11750</td>
      <td>240410569500</td>
      <td>...</td>
      <td>15300</td>
      <td>15400</td>
      <td>12650</td>
      <td>13700</td>
      <td>789063638200</td>
      <td>13700</td>
      <td>16100</td>
      <td>13400</td>
      <td>15400</td>
      <td>897154258000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11950</td>
      <td>12450</td>
      <td>10900</td>
      <td>11750</td>
      <td>240410569500</td>
      <td>11850</td>
      <td>14150</td>
      <td>11600</td>
      <td>12600</td>
      <td>764364560400</td>
      <td>...</td>
      <td>13700</td>
      <td>16100</td>
      <td>13400</td>
      <td>15400</td>
      <td>897154258000</td>
      <td>14700</td>
      <td>15500</td>
      <td>14000</td>
      <td>14350</td>
      <td>277027065700</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11850</td>
      <td>14150</td>
      <td>11600</td>
      <td>12600</td>
      <td>764364560400</td>
      <td>12800</td>
      <td>13200</td>
      <td>12000</td>
      <td>12200</td>
      <td>170010147600</td>
      <td>...</td>
      <td>14700</td>
      <td>15500</td>
      <td>14000</td>
      <td>14350</td>
      <td>277027065700</td>
      <td>13050</td>
      <td>13300</td>
      <td>11650</td>
      <td>11650</td>
      <td>231873876050</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12800</td>
      <td>13200</td>
      <td>12000</td>
      <td>12200</td>
      <td>170010147600</td>
      <td>12450</td>
      <td>13400</td>
      <td>12350</td>
      <td>12850</td>
      <td>211661434950</td>
      <td>...</td>
      <td>13050</td>
      <td>13300</td>
      <td>11650</td>
      <td>11650</td>
      <td>231873876050</td>
      <td>12200</td>
      <td>13150</td>
      <td>11600</td>
      <td>12200</td>
      <td>222393934200</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12450</td>
      <td>13400</td>
      <td>12350</td>
      <td>12850</td>
      <td>211661434950</td>
      <td>12800</td>
      <td>12950</td>
      <td>11300</td>
      <td>11700</td>
      <td>91801277100</td>
      <td>...</td>
      <td>12200</td>
      <td>13150</td>
      <td>11600</td>
      <td>12200</td>
      <td>222393934200</td>
      <td>12200</td>
      <td>13750</td>
      <td>12100</td>
      <td>12350</td>
      <td>256196958550</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 50 columns</p>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
===== trainY =====
trainY shape: (11935, 1)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<hr>
<p><br> <br></p>
<p>4ë‹¨ê³„ì˜ ê³¼ì •ì„ ê±°ì³ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ ìƒì„±ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤. ë‹¤ì–‘í•œ ë°©ë²•ì„ í†µí•´ ì „ì²˜ë¦¬ ì½”ë“œë¥¼ ê°œì„ ì‹œí‚¤ëŠ” ê³¼ì •ì„ ë°°ìš¸ ìˆ˜ ìˆì—ˆê³ , ì‹œê°„ íš¨ìœ¨ì„±ì„ ë†’ì´ëŠ” ê²ƒì€ ì¤‘ìš”í•œ ì‘ì—…ì„ì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤. 17ë¶„ì´ ê±¸ë¦¬ë˜ ì‘ì—…ì„ 8~9ì´ˆë¡œ ì¤„ì˜€ìœ¼ë©°, ë°ì´í„°ê°€ ë§ì•„ì§ˆ ìˆ˜ë¡ ì‹œê°„ì´ ë” ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì— ì‹œê°„ íš¨ìœ¨ì„±ì˜ ì¤‘ìš”ì„±ì´ ì»¤ì§ˆ ê²ƒì…ë‹ˆë‹¤. ë‹¤ìŒ ê¸€ì—ì„œëŠ” ìƒì„±ëœ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í•™ìŠµ ë° í‰ê°€í•˜ì—¬ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì€ ëª¨ë¸ì„ ì„ ì •í•˜ëŠ” <code>baseline model selection</code>ì„ ì§„í–‰í•©ë‹ˆë‹¤.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>