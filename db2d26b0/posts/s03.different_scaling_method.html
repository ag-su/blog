<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="agsu">
<meta name="dcterms.date" content="2023-02-15">

<title>Data Analysis blog - [stockait] stockait 사용하여 주가 데이터 표준화 실험하기</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data Analysis blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ag-su"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://agsu.tistory.com/"><i class="bi bi-box2-heart" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[stockait] stockait 사용하여 주가 데이터 표준화 실험하기</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">project</div>
                <div class="quarto-category">stockait</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>agsu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 15, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> stockait <span class="im">as</span> sai</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>본 글은 같은 트레이더의 조건일 때 네개의 다른 표준화 방법으로 전처리한 데이터셋 중 어떤 데이터셋의 성능이 가장 높게 나오는지 비교 실험을 수행하는 글입니다.</p>
<p><br> <br></p>
<section id="데이터-수집" class="level1">
<h1>1. 데이터 수집</h1>
<p>실험은 한국의 코스피 시장에서 500개의 종목만을 사용해서 주행하도록 하겠습니다.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lst_tickers <span class="op">=</span> sai.get_tickers(markets<span class="op">=</span>[<span class="st">'KOSPI'</span>])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(lst_tickers), lst_tickers[:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>920 ['095570', '006840', '282330', '027410', '138930']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="op">=</span> sai.load_data(date<span class="op">=</span>[<span class="st">'2016-01-01'</span>, <span class="st">'2021-12-31'</span>], tickers<span class="op">=</span>lst_tickers[:<span class="dv">600</span>])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(raw_data.shape)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>raw_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|█████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:38&lt;00:00, 15.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(821266, 7)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Code</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000020</td>
      <td>2016-01-04</td>
      <td>8130</td>
      <td>8150</td>
      <td>7920</td>
      <td>8140</td>
      <td>281440</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000020</td>
      <td>2016-01-05</td>
      <td>8040</td>
      <td>8250</td>
      <td>8000</td>
      <td>8190</td>
      <td>243179</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000020</td>
      <td>2016-01-06</td>
      <td>8200</td>
      <td>8590</td>
      <td>8110</td>
      <td>8550</td>
      <td>609906</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000020</td>
      <td>2016-01-07</td>
      <td>8470</td>
      <td>8690</td>
      <td>8190</td>
      <td>8380</td>
      <td>704752</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000020</td>
      <td>2016-01-08</td>
      <td>8210</td>
      <td>8900</td>
      <td>8130</td>
      <td>8770</td>
      <td>802330</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="데이터-전처리" class="level1">
<h1>2. 데이터 전처리</h1>
<section id="보조지표-추가" class="level3">
<h3 class="anchored" data-anchor-id="보조지표-추가">1) 보조지표 추가</h3>
<p>첫번째로, 보조지표를 추가합니다.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>check_index <span class="op">=</span> [<span class="st">'MA5'</span>, <span class="st">'MA20'</span>, <span class="st">'MA60'</span>,<span class="st">'MA120'</span>, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">'next_change'</span>,<span class="st">'CMF'</span>,<span class="st">'VPT'</span>,<span class="st">'VMAP'</span>, <span class="st">"ADI"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">'BHB'</span>,<span class="st">'BLB'</span>,<span class="st">'KCH'</span>,<span class="st">'KCL'</span>,<span class="st">'KCM'</span>,<span class="st">'DCH'</span>,<span class="st">'DCL'</span>,<span class="st">'DCM'</span>,<span class="st">'UI'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">'SMA'</span>,<span class="st">'EMA'</span>,<span class="st">'WMA'</span>,<span class="st">'MACD'</span>,<span class="st">'VIneg'</span>,<span class="st">'VIpos'</span>,<span class="st">'TRIX'</span>,<span class="st">'MI'</span>,<span class="st">'CCI'</span>,<span class="st">'DPO'</span>,<span class="st">'KST'</span>,<span class="st">'Ichimoku'</span>,<span class="st">'ParabolicSAR'</span>,<span class="st">'STC'</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">'RSI'</span>,<span class="st">'SRSI'</span>,<span class="st">'TSI'</span>,<span class="st">'UO'</span>,<span class="st">'SR'</span>,<span class="st">'WR'</span>,<span class="st">'AO'</span>,<span class="st">'ROC'</span>,<span class="st">'PPO'</span>,<span class="st">'PVO'</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>check_df <span class="op">=</span> sai.add_index(data<span class="op">=</span>raw_data, index_list<span class="op">=</span>check_index)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>check_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|████████████████████████████████████████████████████████████████████████████████████████████████| 595/595 [09:39&lt;00:00,  1.03it/s]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Code</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>MA5</th>
      <th>MA20</th>
      <th>...</th>
      <th>RSI</th>
      <th>SRSI</th>
      <th>TSI</th>
      <th>UO</th>
      <th>SR</th>
      <th>WR</th>
      <th>AO</th>
      <th>ROC</th>
      <th>PPO</th>
      <th>PVO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000020</td>
      <td>2016-06-29</td>
      <td>9850</td>
      <td>10100</td>
      <td>9700</td>
      <td>9750</td>
      <td>352292</td>
      <td>-0.001025</td>
      <td>9544.0</td>
      <td>10210.00</td>
      <td>...</td>
      <td>45.763505</td>
      <td>0.529126</td>
      <td>-8.116135</td>
      <td>0.0</td>
      <td>41.176471</td>
      <td>-58.823529</td>
      <td>-827.794118</td>
      <td>-3.940887</td>
      <td>-1.408719</td>
      <td>-11.019576</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000020</td>
      <td>2016-06-30</td>
      <td>9850</td>
      <td>10400</td>
      <td>9760</td>
      <td>10100</td>
      <td>466248</td>
      <td>0.035897</td>
      <td>9618.0</td>
      <td>10195.00</td>
      <td>...</td>
      <td>51.232344</td>
      <td>0.875363</td>
      <td>-6.553028</td>
      <td>0.0</td>
      <td>54.901961</td>
      <td>-45.098039</td>
      <td>-765.088235</td>
      <td>-2.415459</td>
      <td>-1.124410</td>
      <td>-9.119594</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000020</td>
      <td>2016-07-01</td>
      <td>10200</td>
      <td>10200</td>
      <td>9960</td>
      <td>9960</td>
      <td>208228</td>
      <td>-0.013861</td>
      <td>9794.0</td>
      <td>10148.00</td>
      <td>...</td>
      <td>49.099659</td>
      <td>0.767924</td>
      <td>-5.911240</td>
      <td>0.0</td>
      <td>49.411765</td>
      <td>-50.588235</td>
      <td>-624.205882</td>
      <td>-4.230769</td>
      <td>-1.001426</td>
      <td>-12.558989</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000020</td>
      <td>2016-07-04</td>
      <td>10000</td>
      <td>10400</td>
      <td>9900</td>
      <td>10400</td>
      <td>275210</td>
      <td>0.044177</td>
      <td>9994.0</td>
      <td>10135.50</td>
      <td>...</td>
      <td>55.385557</td>
      <td>1.000000</td>
      <td>-3.312304</td>
      <td>0.0</td>
      <td>66.666667</td>
      <td>-33.333333</td>
      <td>-427.205882</td>
      <td>-0.952381</td>
      <td>-0.541344</td>
      <td>-13.975141</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000020</td>
      <td>2016-07-05</td>
      <td>10400</td>
      <td>10450</td>
      <td>10200</td>
      <td>10350</td>
      <td>156010</td>
      <td>-0.004808</td>
      <td>10112.0</td>
      <td>10118.00</td>
      <td>...</td>
      <td>54.560981</td>
      <td>0.961700</td>
      <td>-1.483696</td>
      <td>0.0</td>
      <td>64.705882</td>
      <td>-35.294118</td>
      <td>-266.529412</td>
      <td>1.970443</td>
      <td>-0.216142</td>
      <td>-17.711174</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>750398</th>
      <td>5307W1</td>
      <td>2021-12-23</td>
      <td>3420</td>
      <td>3480</td>
      <td>3370</td>
      <td>3425</td>
      <td>391929</td>
      <td>0.007353</td>
      <td>3440.0</td>
      <td>3535.00</td>
      <td>...</td>
      <td>40.390231</td>
      <td>0.159714</td>
      <td>-8.758815</td>
      <td>0.0</td>
      <td>20.000000</td>
      <td>-80.000000</td>
      <td>-126.044118</td>
      <td>-5.647383</td>
      <td>-0.810232</td>
      <td>-11.033540</td>
    </tr>
    <tr>
      <th>750399</th>
      <td>5307W1</td>
      <td>2021-12-24</td>
      <td>3465</td>
      <td>3520</td>
      <td>3420</td>
      <td>3500</td>
      <td>313474</td>
      <td>0.021898</td>
      <td>3438.0</td>
      <td>3529.50</td>
      <td>...</td>
      <td>47.968313</td>
      <td>0.589811</td>
      <td>-8.179822</td>
      <td>0.0</td>
      <td>43.076923</td>
      <td>-56.923077</td>
      <td>-138.058824</td>
      <td>-3.047091</td>
      <td>-0.740535</td>
      <td>-10.762865</td>
    </tr>
    <tr>
      <th>750400</th>
      <td>5307W1</td>
      <td>2021-12-27</td>
      <td>3515</td>
      <td>3515</td>
      <td>3465</td>
      <td>3475</td>
      <td>265569</td>
      <td>-0.007143</td>
      <td>3446.0</td>
      <td>3527.25</td>
      <td>...</td>
      <td>45.874782</td>
      <td>0.494226</td>
      <td>-8.285385</td>
      <td>0.0</td>
      <td>35.384615</td>
      <td>-64.615385</td>
      <td>-134.838235</td>
      <td>-4.005525</td>
      <td>-0.734518</td>
      <td>-11.598254</td>
    </tr>
    <tr>
      <th>750401</th>
      <td>5307W1</td>
      <td>2021-12-28</td>
      <td>3500</td>
      <td>3520</td>
      <td>3455</td>
      <td>3515</td>
      <td>359215</td>
      <td>0.011511</td>
      <td>3463.0</td>
      <td>3532.75</td>
      <td>...</td>
      <td>49.660421</td>
      <td>0.719680</td>
      <td>-7.274530</td>
      <td>0.0</td>
      <td>52.542373</td>
      <td>-47.457627</td>
      <td>-114.720588</td>
      <td>-2.361111</td>
      <td>-0.630225</td>
      <td>-9.883604</td>
    </tr>
    <tr>
      <th>750402</th>
      <td>5307W1</td>
      <td>2021-12-29</td>
      <td>3520</td>
      <td>3650</td>
      <td>3490</td>
      <td>3615</td>
      <td>436463</td>
      <td>0.02845</td>
      <td>3506.0</td>
      <td>3539.75</td>
      <td>...</td>
      <td>57.637528</td>
      <td>1.000000</td>
      <td>-3.768305</td>
      <td>0.0</td>
      <td>86.440678</td>
      <td>-13.559322</td>
      <td>-86.279412</td>
      <td>-0.138122</td>
      <td>-0.313929</td>
      <td>-6.618431</td>
    </tr>
  </tbody>
</table>
<p>750403 rows × 50 columns</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="데이터-표준화" class="level3">
<h3 class="anchored" data-anchor-id="데이터-표준화">2) 데이터 표준화</h3>
<p>다음으로 stockait에서 제공하는 네가지의 표준화 방법을 사용하여 데이터를 표준화 합니다.</p>
<p><br></p>
<section id="minmax" class="level4">
<h4 class="anchored" data-anchor-id="minmax">minmax</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>scaled_minmax <span class="op">=</span> sai.scaling(data<span class="op">=</span>check_df, scaler_type<span class="op">=</span><span class="st">"minmax"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>scaled_minmax.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [00:58&lt;00:00, 10.09it/s]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Code</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>MA5</th>
      <th>MA20</th>
      <th>...</th>
      <th>RSI</th>
      <th>SRSI</th>
      <th>TSI</th>
      <th>UO</th>
      <th>SR</th>
      <th>WR</th>
      <th>AO</th>
      <th>ROC</th>
      <th>PPO</th>
      <th>PVO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000020</td>
      <td>2016-06-29</td>
      <td>0.194499</td>
      <td>0.168374</td>
      <td>0.201232</td>
      <td>9750</td>
      <td>352292</td>
      <td>-0.001025</td>
      <td>0.187465</td>
      <td>0.222265</td>
      <td>...</td>
      <td>45.763505</td>
      <td>0.529126</td>
      <td>-8.116135</td>
      <td>0.0</td>
      <td>41.176471</td>
      <td>-58.823529</td>
      <td>-827.794118</td>
      <td>-3.940887</td>
      <td>-1.408719</td>
      <td>-11.019576</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000020</td>
      <td>2016-06-30</td>
      <td>0.194499</td>
      <td>0.17862</td>
      <td>0.203696</td>
      <td>10100</td>
      <td>466248</td>
      <td>0.035897</td>
      <td>0.19065</td>
      <td>0.221465</td>
      <td>...</td>
      <td>51.232344</td>
      <td>0.875363</td>
      <td>-6.553028</td>
      <td>0.0</td>
      <td>54.901961</td>
      <td>-45.098039</td>
      <td>-765.088235</td>
      <td>-2.415459</td>
      <td>-1.124410</td>
      <td>-9.119594</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000020</td>
      <td>2016-07-01</td>
      <td>0.208251</td>
      <td>0.17179</td>
      <td>0.21191</td>
      <td>9960</td>
      <td>208228</td>
      <td>-0.013861</td>
      <td>0.198227</td>
      <td>0.218958</td>
      <td>...</td>
      <td>49.099659</td>
      <td>0.767924</td>
      <td>-5.911240</td>
      <td>0.0</td>
      <td>49.411765</td>
      <td>-50.588235</td>
      <td>-624.205882</td>
      <td>-4.230769</td>
      <td>-1.001426</td>
      <td>-12.558989</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000020</td>
      <td>2016-07-04</td>
      <td>0.200393</td>
      <td>0.17862</td>
      <td>0.209446</td>
      <td>10400</td>
      <td>275210</td>
      <td>0.044177</td>
      <td>0.206836</td>
      <td>0.218291</td>
      <td>...</td>
      <td>55.385557</td>
      <td>1.000000</td>
      <td>-3.312304</td>
      <td>0.0</td>
      <td>66.666667</td>
      <td>-33.333333</td>
      <td>-427.205882</td>
      <td>-0.952381</td>
      <td>-0.541344</td>
      <td>-13.975141</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000020</td>
      <td>2016-07-05</td>
      <td>0.21611</td>
      <td>0.180328</td>
      <td>0.221766</td>
      <td>10350</td>
      <td>156010</td>
      <td>-0.004808</td>
      <td>0.211915</td>
      <td>0.217358</td>
      <td>...</td>
      <td>54.560981</td>
      <td>0.961700</td>
      <td>-1.483696</td>
      <td>0.0</td>
      <td>64.705882</td>
      <td>-35.294118</td>
      <td>-266.529412</td>
      <td>1.970443</td>
      <td>-0.216142</td>
      <td>-17.711174</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="standard" class="level4">
<h4 class="anchored" data-anchor-id="standard">standard</h4>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>scaled_standard <span class="op">=</span> sai.scaling(data<span class="op">=</span>check_df, scaler_type<span class="op">=</span><span class="st">"standard"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>scaled_standard.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [00:26&lt;00:00, 21.84it/s]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Code</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>MA5</th>
      <th>MA20</th>
      <th>...</th>
      <th>RSI</th>
      <th>SRSI</th>
      <th>TSI</th>
      <th>UO</th>
      <th>SR</th>
      <th>WR</th>
      <th>AO</th>
      <th>ROC</th>
      <th>PPO</th>
      <th>PVO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000020</td>
      <td>2016-06-29</td>
      <td>-0.426667</td>
      <td>-0.40741</td>
      <td>-0.422378</td>
      <td>9750</td>
      <td>352292</td>
      <td>-0.001025</td>
      <td>-0.497811</td>
      <td>-0.336067</td>
      <td>...</td>
      <td>45.763505</td>
      <td>0.529126</td>
      <td>-8.116135</td>
      <td>0.0</td>
      <td>41.176471</td>
      <td>-58.823529</td>
      <td>-827.794118</td>
      <td>-3.940887</td>
      <td>-1.408719</td>
      <td>-11.019576</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000020</td>
      <td>2016-06-30</td>
      <td>-0.426667</td>
      <td>-0.339931</td>
      <td>-0.407372</td>
      <td>10100</td>
      <td>466248</td>
      <td>0.035897</td>
      <td>-0.479964</td>
      <td>-0.339741</td>
      <td>...</td>
      <td>51.232344</td>
      <td>0.875363</td>
      <td>-6.553028</td>
      <td>0.0</td>
      <td>54.901961</td>
      <td>-45.098039</td>
      <td>-765.088235</td>
      <td>-2.415459</td>
      <td>-1.124410</td>
      <td>-9.119594</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000020</td>
      <td>2016-07-01</td>
      <td>-0.343357</td>
      <td>-0.384917</td>
      <td>-0.357352</td>
      <td>9960</td>
      <td>208228</td>
      <td>-0.013861</td>
      <td>-0.437518</td>
      <td>-0.351253</td>
      <td>...</td>
      <td>49.099659</td>
      <td>0.767924</td>
      <td>-5.911240</td>
      <td>0.0</td>
      <td>49.411765</td>
      <td>-50.588235</td>
      <td>-624.205882</td>
      <td>-4.230769</td>
      <td>-1.001426</td>
      <td>-12.558989</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000020</td>
      <td>2016-07-04</td>
      <td>-0.390963</td>
      <td>-0.339931</td>
      <td>-0.372358</td>
      <td>10400</td>
      <td>275210</td>
      <td>0.044177</td>
      <td>-0.389284</td>
      <td>-0.354314</td>
      <td>...</td>
      <td>55.385557</td>
      <td>1.000000</td>
      <td>-3.312304</td>
      <td>0.0</td>
      <td>66.666667</td>
      <td>-33.333333</td>
      <td>-427.205882</td>
      <td>-0.952381</td>
      <td>-0.541344</td>
      <td>-13.975141</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000020</td>
      <td>2016-07-05</td>
      <td>-0.295751</td>
      <td>-0.328684</td>
      <td>-0.297327</td>
      <td>10350</td>
      <td>156010</td>
      <td>-0.004808</td>
      <td>-0.360826</td>
      <td>-0.358600</td>
      <td>...</td>
      <td>54.560981</td>
      <td>0.961700</td>
      <td>-1.483696</td>
      <td>0.0</td>
      <td>64.705882</td>
      <td>-35.294118</td>
      <td>-266.529412</td>
      <td>1.970443</td>
      <td>-0.216142</td>
      <td>-17.711174</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="robust" class="level4">
<h4 class="anchored" data-anchor-id="robust">robust</h4>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>scaled_robust <span class="op">=</span> sai.scaling(data<span class="op">=</span>check_df, scaler_type<span class="op">=</span><span class="st">"robust"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>scaled_robust.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [00:44&lt;00:00, 13.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Code</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>MA5</th>
      <th>MA20</th>
      <th>...</th>
      <th>RSI</th>
      <th>SRSI</th>
      <th>TSI</th>
      <th>UO</th>
      <th>SR</th>
      <th>WR</th>
      <th>AO</th>
      <th>ROC</th>
      <th>PPO</th>
      <th>PVO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000020</td>
      <td>2016-06-29</td>
      <td>0.016653</td>
      <td>0.060905</td>
      <td>-0.009898</td>
      <td>9750</td>
      <td>352292</td>
      <td>-0.001025</td>
      <td>-0.037510</td>
      <td>0.080375</td>
      <td>...</td>
      <td>45.763505</td>
      <td>0.529126</td>
      <td>-8.116135</td>
      <td>0.0</td>
      <td>41.176471</td>
      <td>-58.823529</td>
      <td>-827.794118</td>
      <td>-3.940887</td>
      <td>-1.408719</td>
      <td>-11.019576</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000020</td>
      <td>2016-06-30</td>
      <td>0.016653</td>
      <td>0.114006</td>
      <td>0.000723</td>
      <td>10100</td>
      <td>466248</td>
      <td>0.035897</td>
      <td>-0.024412</td>
      <td>0.077720</td>
      <td>...</td>
      <td>51.232344</td>
      <td>0.875363</td>
      <td>-6.553028</td>
      <td>0.0</td>
      <td>54.901961</td>
      <td>-45.098039</td>
      <td>-765.088235</td>
      <td>-2.415459</td>
      <td>-1.124410</td>
      <td>-9.119594</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000020</td>
      <td>2016-07-01</td>
      <td>0.078605</td>
      <td>0.078605</td>
      <td>0.036124</td>
      <td>9960</td>
      <td>208228</td>
      <td>-0.013861</td>
      <td>0.006741</td>
      <td>0.069401</td>
      <td>...</td>
      <td>49.099659</td>
      <td>0.767924</td>
      <td>-5.911240</td>
      <td>0.0</td>
      <td>49.411765</td>
      <td>-50.588235</td>
      <td>-624.205882</td>
      <td>-4.230769</td>
      <td>-1.001426</td>
      <td>-12.558989</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000020</td>
      <td>2016-07-04</td>
      <td>0.043204</td>
      <td>0.114006</td>
      <td>0.025504</td>
      <td>10400</td>
      <td>275210</td>
      <td>0.044177</td>
      <td>0.042142</td>
      <td>0.067188</td>
      <td>...</td>
      <td>55.385557</td>
      <td>1.000000</td>
      <td>-3.312304</td>
      <td>0.0</td>
      <td>66.666667</td>
      <td>-33.333333</td>
      <td>-427.205882</td>
      <td>-0.952381</td>
      <td>-0.541344</td>
      <td>-13.975141</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000020</td>
      <td>2016-07-05</td>
      <td>0.114006</td>
      <td>0.122857</td>
      <td>0.078605</td>
      <td>10350</td>
      <td>156010</td>
      <td>-0.004808</td>
      <td>0.063029</td>
      <td>0.064091</td>
      <td>...</td>
      <td>54.560981</td>
      <td>0.961700</td>
      <td>-1.483696</td>
      <td>0.0</td>
      <td>64.705882</td>
      <td>-35.294118</td>
      <td>-266.529412</td>
      <td>1.970443</td>
      <td>-0.216142</td>
      <td>-17.711174</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="div-close" class="level4">
<h4 class="anchored" data-anchor-id="div-close">div-close</h4>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>scaled_div_close <span class="op">=</span> sai.scaling(data<span class="op">=</span>check_df, scaler_type<span class="op">=</span><span class="st">"div-close"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>scaled_div_close.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [00:26&lt;00:00, 21.94it/s]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Code</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>MA5</th>
      <th>MA20</th>
      <th>...</th>
      <th>RSI</th>
      <th>SRSI</th>
      <th>TSI</th>
      <th>UO</th>
      <th>SR</th>
      <th>WR</th>
      <th>AO</th>
      <th>ROC</th>
      <th>PPO</th>
      <th>PVO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000020</td>
      <td>2016-06-29</td>
      <td>1.010256</td>
      <td>1.035897</td>
      <td>0.994872</td>
      <td>9750</td>
      <td>352292</td>
      <td>-0.001025</td>
      <td>0.978872</td>
      <td>1.047179</td>
      <td>...</td>
      <td>45.763505</td>
      <td>0.529126</td>
      <td>-8.116135</td>
      <td>0.0</td>
      <td>41.176471</td>
      <td>-58.823529</td>
      <td>-827.794118</td>
      <td>-3.940887</td>
      <td>-1.408719</td>
      <td>-11.019576</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000020</td>
      <td>2016-06-30</td>
      <td>1.010256</td>
      <td>1.066667</td>
      <td>1.001026</td>
      <td>10100</td>
      <td>466248</td>
      <td>0.035897</td>
      <td>0.986462</td>
      <td>1.045641</td>
      <td>...</td>
      <td>51.232344</td>
      <td>0.875363</td>
      <td>-6.553028</td>
      <td>0.0</td>
      <td>54.901961</td>
      <td>-45.098039</td>
      <td>-765.088235</td>
      <td>-2.415459</td>
      <td>-1.124410</td>
      <td>-9.119594</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000020</td>
      <td>2016-07-01</td>
      <td>1.009901</td>
      <td>1.009901</td>
      <td>0.986139</td>
      <td>9960</td>
      <td>208228</td>
      <td>-0.013861</td>
      <td>0.969703</td>
      <td>1.004752</td>
      <td>...</td>
      <td>49.099659</td>
      <td>0.767924</td>
      <td>-5.911240</td>
      <td>0.0</td>
      <td>49.411765</td>
      <td>-50.588235</td>
      <td>-624.205882</td>
      <td>-4.230769</td>
      <td>-1.001426</td>
      <td>-12.558989</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000020</td>
      <td>2016-07-04</td>
      <td>1.004016</td>
      <td>1.044177</td>
      <td>0.993976</td>
      <td>10400</td>
      <td>275210</td>
      <td>0.044177</td>
      <td>1.003414</td>
      <td>1.017620</td>
      <td>...</td>
      <td>55.385557</td>
      <td>1.000000</td>
      <td>-3.312304</td>
      <td>0.0</td>
      <td>66.666667</td>
      <td>-33.333333</td>
      <td>-427.205882</td>
      <td>-0.952381</td>
      <td>-0.541344</td>
      <td>-13.975141</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000020</td>
      <td>2016-07-05</td>
      <td>1.0</td>
      <td>1.004808</td>
      <td>0.980769</td>
      <td>10350</td>
      <td>156010</td>
      <td>-0.004808</td>
      <td>0.972308</td>
      <td>0.972885</td>
      <td>...</td>
      <td>54.560981</td>
      <td>0.961700</td>
      <td>-1.483696</td>
      <td>0.0</td>
      <td>64.705882</td>
      <td>-35.294118</td>
      <td>-266.529412</td>
      <td>1.970443</td>
      <td>-0.216142</td>
      <td>-17.711174</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="시계열-데이터-변환" class="level3">
<h3 class="anchored" data-anchor-id="시계열-데이터-변환">3) 시계열 데이터 변환</h3>
<p>하나의 행에 10일치(D-9 ~ D0)의 데이터가 담기도록 데이터셋을 변환합니다.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># original dataset</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_time_series <span class="op">=</span> sai.time_series(check_df, day<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># scaled dataset </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_time_series_minmax <span class="op">=</span> sai.time_series(scaled_minmax, day<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>df_time_series_standard <span class="op">=</span> sai.time_series(scaled_standard, day<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>df_time_series_robust <span class="op">=</span> sai.time_series(scaled_robust, day<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>df_time_series_div_close <span class="op">=</span> sai.time_series(scaled_div_close, day<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [02:19&lt;00:00,  4.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [02:25&lt;00:00,  4.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [02:18&lt;00:00,  4.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [02:18&lt;00:00,  4.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 586/586 [02:18&lt;00:00,  4.23it/s]</code></pre>
</div>
</div>
<p><br> <br></p>
</section>
</section>
<section id="트레이더-정의" class="level1">
<h1>3. 트레이더 정의</h1>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lst_trader <span class="op">=</span> []</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lightgbm <span class="im">import</span> LGBMClassifier</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># conditional_buyer: Object that determines acquisition based on data filtering conditions </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>b1_lg <span class="op">=</span> sai.ConditionalBuyer()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sampling1(df): <span class="co"># Create a conditional function</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    condition1 <span class="op">=</span> (<span class="op">-</span><span class="fl">0.3</span> <span class="op">&lt;=</span> df.D0_Change) <span class="op">&amp;</span> (df.D0_Change <span class="op">&lt;=</span> <span class="fl">0.3</span>) <span class="co"># Remove exceptions that exceed upper and lower limits</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    condition2 <span class="op">=</span> (df.D0_Close <span class="op">*</span> df.D0_Volume) <span class="op">&gt;=</span> <span class="dv">1000000000</span> <span class="co"># condition 1: Transaction amount of more than 1 billion won </span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    condition3 <span class="op">=</span> (<span class="op">-</span><span class="fl">0.05</span> <span class="op">&gt;=</span> df.D0_Change) <span class="op">|</span> (<span class="fl">0.05</span> <span class="op">&lt;=</span> df.D0_Change) <span class="co"># condition 2: Today's stock price change rate is more than 5%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    condition <span class="op">=</span> condition1 <span class="op">&amp;</span> condition2 <span class="op">&amp;</span> condition3</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> condition</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>b1_lg.condition <span class="op">=</span> sampling1  <span class="co"># Define the condition function directly (sampling1) and store it in the condition property </span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># machinelearning_buyer: Object that determines acquisition by machine learning model</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>b2_lg <span class="op">=</span> sai.MachinelearningBuyer()</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Save user-defined models to algorithm properties</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>scale_pos_weight <span class="op">=</span> <span class="bu">round</span>(<span class="dv">72</span><span class="op">/</span><span class="dv">28</span> , <span class="dv">2</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {  <span class="st">'random_state'</span> : <span class="dv">42</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'scale_pos_weight'</span> : scale_pos_weight,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">'learning_rate'</span> : <span class="fl">0.1</span>, </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">'num_iterations'</span> : <span class="dv">1000</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">'max_depth'</span> : <span class="dv">4</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'n_jobs'</span> : <span class="dv">30</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'boost_from_average'</span> : <span class="va">False</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">'objective'</span> : <span class="st">'binary'</span> }</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>b2_lg.algorithm <span class="op">=</span>  LGBMClassifier( <span class="op">**</span>params )</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="co"># SubSeller: Object that determines selling all of the following days</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>sell_all <span class="op">=</span> sai.SubSeller() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>트레이더는 같은 조건으로 생성되어야 하므로 정의를 한 번 해주고, 트레이더를 구분하기 위한 이름만 다르게 하여 lst_trader에 넣어줍니다.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>trader_name <span class="op">=</span> [<span class="st">"trader_minmax"</span>, <span class="st">"trader_standard"</span>, <span class="st">"trader_robust"</span>, <span class="st">"trader_div-close"</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> trader_name:    </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    trader <span class="op">=</span> sai.Trader()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    trader.name <span class="op">=</span> name <span class="co"># Trader's name</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    trader.label <span class="op">=</span> <span class="st">'class&amp;0.02'</span> <span class="co"># Set the Trader dependent variable (do not set if it is regression analysis) </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    trader.buyer <span class="op">=</span> sai.Buyer([b1_lg, b2_lg]) <span class="co"># [ conditional buyer, machinelearning buyer ] </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    trader.seller <span class="op">=</span> sai.Seller(sell_all)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    lst_trader.append(trader)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br> <br></p>
</section>
<section id="트레이더-모델-학습-및-평가" class="level1">
<h1>4. 트레이더 (모델) 학습 및 평가</h1>
<section id="트레이더-객체에-데이터셋-저장" class="level3">
<h3 class="anchored" data-anchor-id="트레이더-객체에-데이터셋-저장">1) 트레이더 객체에 데이터셋 저장</h3>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_time_series <span class="op">=</span> df_time_series[<span class="op">~</span>(df_time_series[<span class="st">"Code"</span>].isin([<span class="st">"33626K"</span>, <span class="st">"33637k"</span>, <span class="st">'33637K'</span>]))]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df_time_series_minmax <span class="op">=</span> df_time_series_minmax[<span class="op">~</span>(df_time_series_minmax[<span class="st">"Code"</span>].isin([<span class="st">"33626K"</span>, <span class="st">"33637k"</span>, <span class="st">'33637K'</span>]))]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_time_series_standard <span class="op">=</span> df_time_series_standard[<span class="op">~</span>(df_time_series_standard[<span class="st">"Code"</span>].isin([<span class="st">"33626K"</span>, <span class="st">"33637k"</span>, <span class="st">'33637K'</span>]))]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>df_time_series_robust <span class="op">=</span> df_time_series_robust[<span class="op">~</span>(df_time_series_robust[<span class="st">"Code"</span>].isin([<span class="st">"33626K"</span>, <span class="st">"33637k"</span>, <span class="st">'33637K'</span>]))]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>df_time_series_div_close <span class="op">=</span> df_time_series_div_close[<span class="op">~</span>(df_time_series_div_close[<span class="st">"Code"</span>].isin([<span class="st">"33626K"</span>, <span class="st">"33637k"</span>, <span class="st">'33637K'</span>]))]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># train, test dataset split</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> df_time_series[(df_time_series[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2017-01-01'</span>) <span class="op">&amp;</span> (df_time_series[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2020-12-31'</span>)]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> df_time_series[(df_time_series[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2021-01-01'</span>) <span class="op">&amp;</span> (df_time_series[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2021-12-31'</span>)]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># train, test dataset split (scaled) </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>train_data_minmax <span class="op">=</span> df_time_series_minmax[(df_time_series_minmax[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2017-01-01'</span>) <span class="op">&amp;</span> (df_time_series_minmax[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2020-12-31'</span>)]</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>test_data_minmax <span class="op">=</span> df_time_series_minmax[(df_time_series_minmax[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2021-01-01'</span>) <span class="op">&amp;</span> (df_time_series_minmax[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2021-12-31'</span>)]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>train_data_standard <span class="op">=</span> df_time_series_standard[(df_time_series_standard[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2017-01-01'</span>) <span class="op">&amp;</span> (df_time_series_standard[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2020-12-31'</span>)]</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>test_data_standard <span class="op">=</span> df_time_series_standard[(df_time_series_standard[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2021-01-01'</span>) <span class="op">&amp;</span> (df_time_series_standard[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2021-12-31'</span>)]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>train_data_robust <span class="op">=</span> df_time_series_robust[(df_time_series_robust[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2017-01-01'</span>) <span class="op">&amp;</span> (df_time_series_robust[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2020-12-31'</span>)]</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>test_data_robust <span class="op">=</span> df_time_series_robust[(df_time_series_robust[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2021-01-01'</span>) <span class="op">&amp;</span> (df_time_series_robust[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2021-12-31'</span>)]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>train_data_div_close <span class="op">=</span> df_time_series_div_close[(df_time_series_div_close[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2017-01-01'</span>) <span class="op">&amp;</span> (df_time_series_div_close[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2020-12-31'</span>)]</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>test_data_div_close <span class="op">=</span> df_time_series_div_close[(df_time_series_div_close[<span class="st">'Date'</span>] <span class="op">&gt;=</span> <span class="st">'2021-01-01'</span>) <span class="op">&amp;</span> (df_time_series_div_close[<span class="st">'Date'</span>] <span class="op">&lt;=</span> <span class="st">'2021-12-31'</span>)]</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lst_dataset_scaled <span class="op">=</span> [[train_data_minmax, test_data_minmax], </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                      [train_data_standard, test_data_standard],</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                     [train_data_robust, test_data_robust],</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                     [train_data_div_close, test_data_div_close]]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>): </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    lst_trader_one <span class="op">=</span> [lst_trader[i]]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    sai.save_dataset(lst_trader_one, train_data, test_data, lst_dataset_scaled[i][<span class="dv">0</span>], lst_dataset_scaled[i][<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_minmax ==
== train_code_date: (542390, 2),  test_code_date: (139968, 2) ==
== trainX: (542390, 470),  testX: (139968, 470) ==
== trainX_scaled: (542390, 470),  testX_scaled: (139968, 470) ==
== trainY: (542390,),  testY: (139968,) ==
== trainY_classification: (542390,),  testY_classification: (139968,) ==

== trader_standard ==
== train_code_date: (542390, 2),  test_code_date: (139968, 2) ==
== trainX: (542390, 470),  testX: (139968, 470) ==
== trainX_scaled: (542390, 470),  testX_scaled: (139968, 470) ==
== trainY: (542390,),  testY: (139968,) ==
== trainY_classification: (542390,),  testY_classification: (139968,) ==

== trader_robust ==
== train_code_date: (542390, 2),  test_code_date: (139968, 2) ==
== trainX: (542390, 470),  testX: (139968, 470) ==
== trainX_scaled: (542390, 470),  testX_scaled: (139968, 470) ==
== trainY: (542390,),  testY: (139968,) ==
== trainY_classification: (542390,),  testY_classification: (139968,) ==

== trader_div-close ==
== train_code_date: (542390, 2),  test_code_date: (139968, 2) ==
== trainX: (542390, 470),  testX: (139968, 470) ==
== trainX_scaled: (542390, 470),  testX_scaled: (139968, 470) ==
== trainY: (542390,),  testY: (139968,) ==
== trainY_classification: (542390,),  testY_classification: (139968,) ==
</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="모델-학습" class="level3">
<h3 class="anchored" data-anchor-id="모델-학습">2) 모델 학습</h3>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sai.trader_train(lst_trader) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_minmax Model Fitting Completed ==
== trader_standard Model Fitting Completed ==
== trader_robust Model Fitting Completed ==
== trader_div-close Model Fitting Completed ==</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="모델-평가-및-임계값-설정" class="level3">
<h3 class="anchored" data-anchor-id="모델-평가-및-임계값-설정">3) 모델 평가 및 임계값 설정</h3>
<section id="모델-평가" class="level4">
<h4 class="anchored" data-anchor-id="모델-평가">모델 평가</h4>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sai.get_eval_by_threshold(lst_trader)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-17-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-17-output-4.png" class="img-fluid"></p>
</div>
</div>
<p><br></p>
</section>
<section id="임계값-설정" class="level4">
<h4 class="anchored" data-anchor-id="임계값-설정">임계값 설정</h4>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sai.set_threshold(lst_trader, lst_threshold<span class="op">=</span>[<span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>], histogram<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Error: local variable 'threshold' referenced before assignment</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-18-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-18-output-7.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-18-output-10.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x720 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-18-output-13.png" class="img-fluid"></p>
</div>
</div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="backtesting" class="level1">
<h1>4. BackTesting</h1>
<p><br></p>
<section id="매매일지-작성" class="level3">
<h3 class="anchored" data-anchor-id="매매일지-작성">1) 매매일지 작성</h3>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_signal_all <span class="op">=</span> sai.decision(lst_trader, dtype<span class="op">=</span><span class="st">'test'</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df_signal_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>139968it [00:03, 36309.18it/s]
139968it [00:03, 35560.93it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_minmax completed ==</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>139968it [00:03, 36491.79it/s]
139968it [00:03, 36350.87it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_standard completed ==</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>139968it [00:03, 35696.38it/s]
139968it [00:03, 36391.64it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_robust completed ==</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>139968it [00:03, 36208.76it/s]
139968it [00:03, 35618.92it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_div-close completed ==</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Trader_id</th>
      <th>Date</th>
      <th>Code</th>
      <th>+(buy)/-(sell)</th>
      <th>Amount</th>
      <th>Close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>trader_minmax</td>
      <td>2021-01-04</td>
      <td>000020</td>
      <td>+</td>
      <td>0.0</td>
      <td>19100.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>trader_minmax</td>
      <td>2021-01-05</td>
      <td>000020</td>
      <td>+</td>
      <td>0.0</td>
      <td>19400.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>trader_minmax</td>
      <td>2021-01-06</td>
      <td>000020</td>
      <td>+</td>
      <td>0.0</td>
      <td>19700.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>trader_minmax</td>
      <td>2021-01-07</td>
      <td>000020</td>
      <td>+</td>
      <td>0.0</td>
      <td>19700.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>trader_minmax</td>
      <td>2021-01-08</td>
      <td>000020</td>
      <td>+</td>
      <td>0.0</td>
      <td>19100.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>139963</th>
      <td>trader_div-close</td>
      <td>2021-12-22</td>
      <td>5307W1</td>
      <td>-</td>
      <td>1.0</td>
      <td>3400.0</td>
    </tr>
    <tr>
      <th>139964</th>
      <td>trader_div-close</td>
      <td>2021-12-23</td>
      <td>5307W1</td>
      <td>-</td>
      <td>1.0</td>
      <td>3425.0</td>
    </tr>
    <tr>
      <th>139965</th>
      <td>trader_div-close</td>
      <td>2021-12-24</td>
      <td>5307W1</td>
      <td>-</td>
      <td>1.0</td>
      <td>3500.0</td>
    </tr>
    <tr>
      <th>139966</th>
      <td>trader_div-close</td>
      <td>2021-12-27</td>
      <td>5307W1</td>
      <td>-</td>
      <td>1.0</td>
      <td>3475.0</td>
    </tr>
    <tr>
      <th>139967</th>
      <td>trader_div-close</td>
      <td>2021-12-28</td>
      <td>5307W1</td>
      <td>-</td>
      <td>1.0</td>
      <td>3515.0</td>
    </tr>
  </tbody>
</table>
<p>1119744 rows × 6 columns</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="simulation-수익률-계산" class="level3">
<h3 class="anchored" data-anchor-id="simulation-수익률-계산">2) Simulation: 수익률 계산</h3>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df_history_all <span class="op">=</span> sai.simulation(df_signal_all, init_budget<span class="op">=</span><span class="dv">10000000</span>, init_stock<span class="op">=</span>{}, fee<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df_history_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|███████████████████████████████████████████████████████████████████████████████████████████████▌| 245/246 [00:10&lt;00:00, 24.31it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_div-close completed ==</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|███████████████████████████████████████████████████████████████████████████████████████████████▌| 245/246 [00:10&lt;00:00, 24.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_minmax completed ==</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|███████████████████████████████████████████████████████████████████████████████████████████████▌| 245/246 [00:10&lt;00:00, 24.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_robust completed ==</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|███████████████████████████████████████████████████████████████████████████████████████████████▌| 245/246 [00:10&lt;00:00, 24.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>== trader_standard completed ==</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Trader_id</th>
      <th>Sell_date</th>
      <th>Budget</th>
      <th>Yield</th>
      <th>Stock</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>trader_div-close</td>
      <td>2021-01-04</td>
      <td>10000000</td>
      <td>0.000000</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>trader_div-close</td>
      <td>2021-01-05</td>
      <td>10860611</td>
      <td>8.606110</td>
      <td>{'006340': 7142}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>trader_div-close</td>
      <td>2021-01-06</td>
      <td>10860611</td>
      <td>8.606110</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>trader_div-close</td>
      <td>2021-01-07</td>
      <td>10860611</td>
      <td>8.606110</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>trader_div-close</td>
      <td>2021-01-08</td>
      <td>10860611</td>
      <td>8.606110</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>241</th>
      <td>trader_standard</td>
      <td>2021-12-22</td>
      <td>8866099</td>
      <td>-11.339006</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>242</th>
      <td>trader_standard</td>
      <td>2021-12-23</td>
      <td>8866099</td>
      <td>-11.339006</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>243</th>
      <td>trader_standard</td>
      <td>2021-12-24</td>
      <td>8866099</td>
      <td>-11.339006</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>244</th>
      <td>trader_standard</td>
      <td>2021-12-27</td>
      <td>8866099</td>
      <td>-11.339006</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>245</th>
      <td>trader_standard</td>
      <td>2021-12-28</td>
      <td>8866099</td>
      <td>-11.339006</td>
      <td>{}</td>
    </tr>
  </tbody>
</table>
<p>984 rows × 5 columns</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="리더보드" class="level3">
<h3 class="anchored" data-anchor-id="리더보드">3) 리더보드</h3>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sai.leaderboard(df_history_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Trader_id</th>
      <th>Yield</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>trader_div-close</td>
      <td>69.888981</td>
    </tr>
    <tr>
      <th>1</th>
      <td>trader_standard</td>
      <td>-11.339006</td>
    </tr>
    <tr>
      <th>2</th>
      <td>trader_robust</td>
      <td>-22.930525</td>
    </tr>
    <tr>
      <th>3</th>
      <td>trader_minmax</td>
      <td>-26.364585</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="시각화-결과" class="level3">
<h3 class="anchored" data-anchor-id="시각화-결과">4) 시각화 결과</h3>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sai.yield_plot(df_history_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="s03.different_scaling_method_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>div-close</code> 표준화 방법이 다른 방법들보다 수익률이 상당히 높게 나온 것을 확인할 수 있습니다.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>